---
title: "Практическая работа 003"
author: "trembochev@yandex.ru"
format: 
  md:
    output-file: README.md
---

## Цель работы

1. Развить практические навыки использования языка программирования R для обработки данных
2. Закрепить знания базовых типов данных языка R
3. Развить практические навыки использования функций обработки данных пакета `dplyr` – функции `select(), filter(), mutate(), arrange(), group_by()`

## Исходные данные

1. Программное обеспечение Windows 11
2. Rstudio Desktop
3. Интерпретатор языка R 4.5.2

## Задание
Проанализировать встроенный в пакет nycflights13 набор данных языка R и ответить на вопросы.

## Ход работы

1. Установить nycflight13
2. Подключить библиотеку dplyr и nycflights13
3. Проанализировать встроенные в пакет nycflights13 наборы данных с помощью
языка R и ответить на вопросы:
    - Сколько встроенных в пакет nycflights13 датафреймов?
    - Сколько строк в каждом датафрейме?
    - Сколько столбцов в каждом датафрейме?
    - Как просмотреть примерный вид датафрейма?
    - Сколько компаний-перевозчиков (carrier) учитывают эти наборы данных (представлено в наборах данных)?
    - Сколько рейсов принял аэропорт John F Kennedy Intl в мае?
    - Какой самый северный аэропорт?
    - Какой аэропорт самый высокогорный (находится выше всех над уровнем моря)?
    - Какие бортовые номера у самых старых самолетов?
    - Какая средняя температура воздуха была в сентябре в аэропорту John FKennedy Intl (в градусах Цельсия).
    - Самолеты какой авиакомпании совершили больше всего вылетов в июне?
    - Самолеты какой авиакомпании задерживались чаще других в 2013 году?
4. Оформить отчет в соответствии с шаблоном

### Шаг 1

Установим пакет с помощью install.packages('nycflights13')

```
> install.packages('nycflights13')
WARNING: Rtools is required to build R packages but is not currently installed. Please download and install the appropriate version of Rtools before proceeding:

https://cran.rstudio.com/bin/windows/Rtools/
Устанавливаю пакет в ‘C:/Users/Trembachevs/AppData/Local/R/win-library/4.5’
(потому что ‘lib’ не определено)
пробую URL 'https://cran.rstudio.com/bin/windows/contrib/4.5/nycflights13_1.0.2.zip'
Content type 'application/zip' length 4511564 bytes (4.3 MB)
downloaded 4.3 MB

пакет ‘nycflights13’ успешно распакован, MD5-суммы проверены

Скачанные бинарные пакеты находятся в
	C:\Users\Trembachevs\AppData\Local\Temp\RtmpItuDfG\downloaded_packages
> 
```

### Шаг 2

Подключим необходимые библиотеки

```{r}
library(nycflights13)
```

```{r}
library(dplyr)
```

### Шаг 3

#### Сколько встроенных в пакет nycflights13 датафреймов?

```{r}
length(data(package = "nycflights13")$results[, "Item"])
```

#### Сколько строк в каждом датафрейме?

```{r}
airports %>% nrow()
```

```{r}
airlines %>% nrow()
```

```{r}
flights %>% nrow()
```

```{r}
weather %>% nrow()
```

```{r}
planes %>% nrow()
```


#### Сколько столбцов в каждом датафрейме?

```{r}
airports %>% ncol()
```

```{r}
airlines %>% ncol()
```

```{r}
flights %>% ncol()
```

```{r}
weather %>% ncol()
```

```{r}
planes %>% ncol()
```


#### Как просмотреть примерный вид датафрейма?

```{r}
airports %>% glimpse()
```

```{r}
airlines %>% glimpse()
```

```{r}
flights %>% glimpse()
```

```{r}
weather %>% glimpse()
```

```{r}
planes %>% glimpse()
```

#### Сколько компаний-перевозчиков (carrier) учитывают эти наборы данных (представлено в наборах данных)?

```{r}
airlines$carrier %>% n_distinct()
```


#### Сколько рейсов принял аэропорт John F Kennedy Intl в мае?

```{r}
flights %>% filter(origin == "JFK", month == 5) %>%  nrow()
```


#### Какой самый северный аэропорт?


```{r}
airports %>% filter(airports$lon==max(airports$lon)) %>% pull("name")
```


#### Какой аэропорт самый высокогорный (находится выше всех над уровнем моря)?


```{r}
airports %>% filter(airports$alt==max(airports$alt)) %>% pull("name")
```

#### Какие бортовые номера у самых старых самолетов?

```{r}
planes %>%arrange(year) %>% head(10) %>% select(tailnum)
```


#### Какая средняя температура воздуха была в сентябре в аэропорту John F Kennedy Intl (в градусах Цельсия).

```{r}
weather %>%  filter(origin == "JFK", month == 9) %>%  summarise(temp_c = mean((temp - 32) * 5/9, na.rm = TRUE))
```

#### Самолеты какой авиакомпании совершили больше всего вылетов в июне?

```{r}
flights %>% left_join(., airlines, join_by(carrier))  %>% filter(month == 6) %>%count(name, sort = TRUE) %>% head(1)
```


#### Самолеты какой авиакомпании задерживались чаще других в 2013 году?

```{r}
flights %>% left_join(., airlines, join_by(carrier)) %>% group_by(., name) %>% filter(., arr_delay > 0 & year == 2013) %>% summarise(., amount = n()) %>% arrange(., desc(amount)) %>% select(., name) %>% head(1)
```

### Шаг 4

Отчёт написан и оформлен

## Оценка результатов

Задача решена с использованием языка программирования R и пакета `dplyr`. Я научился использовать эти два инструмента для анализа данных на более продвинутом уровне.

## Вывод

В данной работе я ответил на вопросы путем анализа и обработки датафрейфов встроенные в пакет 
`nycflights13` и развил практические навыки